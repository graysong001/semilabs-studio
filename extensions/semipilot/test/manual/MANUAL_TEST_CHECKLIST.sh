#!/bin/bash
# @SpecTrace cap-ui-task-list v1.0.0
# 
# 手动测试清单 - 在VS Code Extension Development Host中执行
# 
# 使用方法：
# 1. 在VS Code中打开 semilabs-studio 项目
# 2. 按 F5 启动 Extension Development Host
# 3. 在新窗口中按照此清单逐项测试

cat << 'EOF'

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 任务列表UI - 手动测试清单
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

测试环境：VS Code Extension Development Host
测试范围：任务列表v1.0.0全功能
预计时间：15-20分钟

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【前置准备】

□ 启动Extension Development Host (F5)
□ 打开包含Spec的工作区
□ 打开Semipilot Chat Panel
□ 确认Console无错误日志

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━◊

【测试组1：基础功能 - Happy Path】

测试1.1：输入/tasks展示任务列表
  操作：
    1. 在Chat Panel输入框输入 "/tasks"
    2. 按 Enter 键
  
  预期结果：
    □ 在聊天区显示任务列表卡片
    □ 标题显示 "📋 未完成任务 (X个)"
    □ 每个任务显示优先级图标（🔴/🟡/🟢）
    □ 每个任务显示状态 [IN_PROGRESS]/[PAUSED]/[PENDING]
    □ 每个任务ID为蓝色链接（可点击）
    □ 显示提示文本："提示：点击任务ID查看详情"
    □ 任务按分数降序排列
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试1.2：点击任务打开文档
  操作：
    1. 点击任务列表中的任务ID链接
  
  预期结果：
    □ 在VS Code主编辑区打开任务文档
    □ 在新标签页打开（不覆盖当前文件）
    □ 自动滚动到文件顶部
    □ 光标定位到第一行（行号为1）
    □ 文件内容正确显示
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试1.3：快速点击多个任务
  操作：
    1. 快速连续点击3个不同任务ID
  
  预期结果：
    □ 打开3个新标签页
    □ 每个标签页对应正确的任务文件
    □ 没有出现竞争条件或错误
    □ 每个标签页独立滚动到顶部
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试1.4：智能排序验证
  操作：
    1. 查看任务列表的排序
    2. 检查score值
  
  预期结果：
    □ IN_PROGRESS任务排在PENDING之前
    □ HIGH优先级排在MEDIUM之前
    □ 有阻塞关系的任务排序靠前
    □ score值递减排列
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【测试组2：错误处理】

测试2.1：工作区无未完成任务
  操作：
    1. 将所有任务标记为COMPLETED
    2. 输入 "/tasks"
  
  预期结果：
    □ 显示空状态消息
    □ 显示文本包含 "所有任务已完成" 或类似提示
    □ 不显示任务列表
    □ 无错误日志
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试2.2：工作区未初始化
  操作：
    1. 在空工作区或无_projects目录的工作区测试
    2. 输入 "/tasks"
  
  预期结果：
    □ 显示友好提示
    □ 显示文本包含 "未检测到任务" 或类似提示
    □ 不抛出错误
    □ Console有正常日志
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试2.3：点击已删除的任务
  操作：
    1. 显示任务列表
    2. 删除某个任务文件
    3. 点击该任务ID
  
  预期结果：
    □ 显示错误提示弹窗
    □ 错误消息包含 "无法打开任务文档"
    □ Console记录错误日志
    □ 不导致Extension崩溃
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试2.4：Frontmatter格式错误
  操作：
    1. 创建任务文件但缺少task_id字段
    2. 输入 "/tasks"
  
  预期结果：
    □ 跳过该文件
    □ Console有警告日志
    □ 继续扫描其他任务
    □ 不中断扫描流程
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【测试组3：边界场景】

测试3.1：单个任务
  操作：
    1. 工作区只保留1个未完成任务
    2. 输入 "/tasks"
  
  预期结果：
    □ 显示任务列表
    □ 标题显示 "📋 未完成任务 (1个)"
    □ 任务信息正常显示
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试3.2：大量任务（>20个）
  操作：
    1. 工作区包含20+个未完成任务
    2. 输入 "/tasks"
    3. 测量响应时间
  
  预期结果：
    □ 显示所有任务
    □ 扫描+渲染时间 < 2秒
    □ Chat Panel支持滚动查看
    □ UI不卡顿
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试3.3：/help命令
  操作：
    1. 输入 "/help"
  
  预期结果：
    □ 显示命令帮助列表
    □ 包含 "/tasks" 命令说明
    □ 包含 "/help" 命令说明
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试3.4：非命令输入
  操作：
    1. 输入普通文本 "Hello, how are you?"
    2. 按 Enter
  
  预期结果：
    □ 不触发/tasks命令
    □ 识别为普通聊天消息
    □ 正常发送到后端（如果后端已启动）
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【测试组4：UI交互】

测试4.1：链接悬停效果
  操作：
    1. 鼠标悬停在任务ID链接上
  
  预期结果：
    □ 鼠标指针变为pointer
    □ 链接有下划线或颜色变化
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试4.2：Console日志完整性
  操作：
    1. 执行 "/tasks" 命令
    2. 点击任务
    3. 查看Developer Console
  
  预期结果：
    □ [SlashCommandHandler] 日志正常
    □ [SemipilotWebviewProvider] 日志正常
    □ [App] Opening task 日志正常
    □ [taskCommands] 日志正常
    □ 无未捕获错误
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试4.3：窗口尺寸变化
  操作：
    1. 显示任务列表
    2. 缩小Chat Panel宽度到最小
  
  预期结果：
    □ 任务列表仍可读
    □ 无布局错位
    □ 链接仍可点击
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【测试组5：性能】

测试5.1：扫描性能
  操作：
    1. 准备100个spec-task文件
    2. 输入 "/tasks"
    3. 测量响应时间
  
  预期结果：
    □ 扫描时间 < 1秒
    □ UI响应流畅
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

测试5.2：内存占用
  操作：
    1. 多次执行 "/tasks" 命令
    2. 查看Extension Host进程内存
  
  预期结果：
    □ 无内存泄漏
    □ 内存稳定
  
  实际结果：[ PASS / FAIL ]
  备注：_____________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【测试总结】

总测试项：20
通过数量：___
失败数量：___
跳过数量：___

通过率：____%

关键问题：
1. _____________________________________
2. _____________________________________
3. _____________________________________

优化建议：
1. _____________________________________
2. _____________________________________
3. _____________________________________

测试人：___________
测试日期：___________
测试环境：VS Code v_______, Extension v_______

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

EOF
